var draw=function(){var e=document.querySelector("main").offsetWidth,t=document.querySelector("main").offsetHeight,n=document.createElement("canvas"),o=n.getContext("2d"),r=n.getBoundingClientRect(),i=0,a=0;x1=0,y1=0,x2=0,y2=0,lx=!1,ly=!1,shape="",isDrawing=!1;var l="",d="",s=[],c=0;return{setXY:function(e){lx=i,ly=a,i=e.clientX-r.left-n.offsetLeft,a=e.clientY-r.top-n.offsetTop},writeXY:function(){document.getElementById("trackX").innerHTML="X: "+i,document.getElementById("trackY").innerHTML="Y: "+a},setStart:function(){x1=i,y1=a},setEnd:function(){x2=i,y2=a},setPoint:function(){s[c]=[],s[c].x=i,s[c].y=a,s.length>2?(this.draw(),c=0,s=[]):c++},setShape:function(e){shape=e},randColor:function(){return"#"+Math.floor(16777215*Math.random()).toString(16)},setStrokeColor:function(e){l=e},getStrokeColor:function(){return l.length>6?l:this.randColor()},setFillColor:function(e){d=e},getFillColor:function(){return d.length>6?d:this.randColor()},setIsDrawing:function(e){isDrawing=e},getIsDrawing:function(){return isDrawing},draw:function(){o.restore(),"rectangle"===shape?this.drawRect():"line"===shape?this.drawLine():"circle"===shape?this.drawCircle():"path"===shape?this.drawPath():"triangle"===shape?this.drawTriangle():"3-point"===shape?this.draw3Point():alert("Please choose a shape"),o.save()},drawRect:function(){o.strokeStyle=this.getStrokeColor(),o.fillStyle=this.getFillColor(),o.fillRect(x1,y1,x2-x1,y2-y1),o.stroke()},drawLine:function(){o.strokeStyle=this.getStrokeColor(),o.beginPath(),o.moveTo(x1,y1),o.lineTo(x2,y2),o.stroke()},drawCircle:function(){o.strokeStyle=this.getStrokeColor(),o.fillStyle=this.getFillColor();let e=x1-x2,t=y1-y2,n=Math.sqrt(e*e+t*t);o.beginPath(),o.arc(x1,y1,n,0,2*Math.PI),o.stroke(),o.fill()},drawPath:function(){o.strokeStyle=this.getStrokeColor(),o.beginPath(),o.moveTo(lx,ly),o.lineTo(i,a),o.stroke()},drawTriangle:function(){var e=x1-x2,t=y1-y2,n=Math.sqrt(e*e+t*t),r=x1+n,i=y1+n;x1>x2&&(r=x1-n),y1>y2&&(i=y1-n),o.fillStyle=this.getFillColor(),o.strokeStyle=this.getStrokeColor(),o.beginPath(),o.moveTo(x1,y1),o.lineTo(r,i),o.lineTo(x2,y2),o.lineTo(x1,y1),o.stroke(),o.fill()},draw3Point:function(){o.fillStyle=this.getFillColor(),o.strokeStyle=this.getStrokeColor(),o.beginPath(),o.moveTo(s[0].x,s[0].y),o.lineTo(s[1].x,s[1].y),o.lineTo(s[2].x,s[2].y),o.lineTo(s[0].x,s[0].y),o.stroke(),o.fill()},getShape:function(){return shape},getCanvas:function(){return n},init:function(){n.width=e,n.height=t,document.querySelector("main").appendChild(n)}}}();draw.init(),document.getElementById("btnRect").addEventListener("click",function(){draw.setShape("rectangle")},!1),document.getElementById("btnLine").addEventListener("click",function(){draw.setShape("line")},!1),document.getElementById("btnCircle").addEventListener("click",function(){draw.setShape("circle")},!1),document.getElementById("btnPath").addEventListener("click",function(){draw.setShape("path")},!1),document.getElementById("btnTriangle").addEventListener("click",function(){draw.setShape("triangle")},!1),document.getElementById("btn3Point").addEventListener("click",function(){draw.setShape("3-point")}),draw.getCanvas().addEventListener("mousemove",function(e){draw.setXY(e),draw.writeXY(),"path"==draw.getShape()&&!0===draw.getIsDrawing()&&draw.draw()},!1),draw.getCanvas().addEventListener("mousedown",function(){"3-point"!==draw.getShape()&&(draw.setStart(),draw.setIsDrawing(!0))},!1),draw.getCanvas().addEventListener("mouseup",function(){"3-point"!==draw.getShape()&&(draw.setEnd(),draw.draw(),draw.setIsDrawing(!1)),"3-point"===draw.getShape()&&draw.setPoint()},!1),document.getElementById("strokeColor").addEventListener("change",function(){draw.setStrokeColor(document.getElementById("strokeColor").value)}),document.getElementById("randStrokeColor").addEventListener("change",function(){draw.setStrokeColor("")}),document.getElementById("fillColor").addEventListener("change",function(){draw.setFillColor(document.getElementById("fillColor").value)}),document.getElementById("randFillColor").addEventListener("change",function(){draw.setFillColor("")});